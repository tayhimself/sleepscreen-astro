---
import Layout from "../layouts/Layout.astro"
import Notice from "../components/Notice.astro"
---

<Layout>
  <main class="bg-base-200">
    <section class="max-w-2xl md:max-w-4xl mx-auto grid grid-cols-1 place-items-stretch min-h-screen">
      <div class="hero">
        <div class="hero-content flex-col leading-relaxed hidden" id="save-content">
          <div class="flex items-center space-x-4">
            <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 16 16"><path fill="currentColor" fill-rule="evenodd" d="M1.75 1a.75.75 0 0 0 0 1.5h8.5a.75.75 0 0 0 0-1.5h-8.5ZM1 4.75A.75.75 0 0 1 1.75 4H7a.75.75 0 0 1 0 1.5H1.75A.75.75 0 0 1 1 4.75Zm9 7.75a2.5 2.5 0 1 0 0-5a2.5 2.5 0 0 0 0 5Zm0 1.5c.834 0 1.607-.255 2.248-.691l1.472 1.471a.75.75 0 1 0 1.06-1.06l-1.471-1.472A4 4 0 1 0 10 14ZM1.75 7a.75.75 0 0 0 0 1.5H4A.75.75 0 0 0 4 7H1.75Z" clip-rule="evenodd"></path></svg>
            <h1 class="text-3xl font-bold">Sleep Screen Results</h1>
          </div>

          <div>
            <p class="my-2 low-risk text-xl">Based on the answers you provided, there was not enough evidence to indicate that you are at high risk of having any of the sleep disorders screened for in the questionnaire.</p>
            <p class="my-2 high-risk text-xl">Based on the answers you provided, you may be at high risk of having one or more of the following sleep disorders:</p>
            <div class="my-2 p-2 osa rounded-md mix-blend-darken bg-yellow-100 hidden">
              <h3 class="text-xl font-bold">Obstructive Sleep Apnea</h3>
              Obstructive Sleep Apnea is a sleep-related breathing disorder that causes your body to stop breathing during sleep. Sleep apnea may increase the risk of motor vehicle accidents and the long-term risk of high blood pressure, diabetes, and other diseases if left untreated. Fatigue due to sleep apnea may increase the risk of drowsy driving that may lead to an auto accident as you drive home from work.
            </div>
            <div class="my-2 p-2 insomnia rounded-md mix-blend-darken bg-yellow-100 hidden">
              <h3 class="text-xl font-bold">Insomnia</h3>
              Insomnia is a common sleep disorder with three common symptoms: difficulty falling asleep, difficulty staying asleep and waking up too early resulting in problems functioning during the day. Someone with insomnia may feel tired and grumpy during the day, have trouble concentrating at work, and may fall asleep during the day. Stress or depression can cause a higher level of insomnia that may last for several weeks and may not go away on its own. Fatigue due to insomnia may increase the risk of drowsy driving that may lead to an auto accident as you drive home from work.
            </div>
            <div class="my-2 p-2 swd rounded-md mix-blend-darken bg-yellow-100 hidden">
              <h3 class="text-xl font-bold">Shift Work Disorder</h3>
              <h2 class="text-lg font-semibold">(Circadian Rhythm Sleep Disorder, Shift Work Type)</h2>
              <p>The major symptoms of Shift Work Disorder are excessive sleepiness and insomnia resulting from work shifts that conflict with your natural sleep cycle. Night, early morning, and rotating shifts require you to be awake when your body wants to sleep, and to sleep when your body wants to be awake. According to a National Sleep Foundation poll, 61% of shift workers experience insomnia and 30% suffer from excessive sleepiness. Other symptoms can include headaches, the inability to concentrate, and lack of energy and motivation. Fatigue due to SWD may increase both the risk of errors that result in incidents and injuries, and drowsy driving that may lead to an automobile crash.</p>
              <p class="multiple my-2">Symptoms of SWD may also be caused by other sleep disorder or medical conditions. Therefore, it is important to discuss your symptoms with your physician to determine their cause and the best treatment options.</p>
            </div>
            <div class="my-2 p-2 rls rounded-md mix-blend-darken bg-yellow-100 hidden">
              <h3 class="text-xl font-bold">Restless Legs Syndrome</h3>
              Restless Legs Syndrome (RLS) is when you have a strong urge to move your legs. The sensation might be like burning, prickling, itching or tingling. RLS can make it difficult for you to fall and stay asleep. Affected persons often need to get out of bed and walk around to relieve their discomfort. Inability to fall sleep can resulting in fatigue and sleepiness during the day. It can also play a part in causing depression or anxiety. Fatigue due to RLS may increase the risk of drowsy driving that may lead to an auto accident as you drive home from work.
            </div>

            <div class="my-2 p-2 hypersomnia rounded-md mix-blend-darken bg-yellow-100 hidden">
              <h3 class="text-xl font-bold">Hypersomnia</h3>
              <p>Hypersomnia is a chronic neurological sleep disorder, causing excessive daytime sleepiness despite adequate, or more typically, long sleep amounts (more than 9-10 hours in a 24-hour period). People with IH often struggle to wake, despite setting multiple alarms. They may have a temporary disorientation and a reduction in mental performance called sleep inertia. In some cases the sleep inertia is accompanied by irritability, physical aggressiveness and automatic/robotic type behavior (called sleep drunkeness). They can experience significantly reduced focus and concentration during waking hours (called brain fog).</p>
              <p>People suffering from idiopathic hypersomnia often live without a correct diagnosis for a long time, blaming themselves and struggling to maintain work, studies and relationships.</p>
            </div>

            <p class="my-2">However, the screening calculation is not able to take into account information specific to you that your physician may know. If you are concerned for any reason about your sleep, a sleep disorder, or another health condition, you should see your physician regardless of your results.</p>
            <p class="my-2">If you are concerned about your sleep, you may want to consider a sleep study. A sleep study is a test that records your body functions during sleep. It is used to diagnose sleep disorders such as sleep apnea, hypersomnia, and restless legs syndrome. A sleep study is usually done in a sleep center, but some sleep centers have portable equipment that can be used in your home.</p>
            <p class="my-2 high-risk">We suggest that you share these screening results with your health care provider or a sleep specialist for evaluation. If you have questions concerning this notification, please contact us via email at sleephealthstudy@partners.org.</p>
            <p class="my-4 high-risk mx-auto text-center">
              <a class="btn btn-primary" href="http://www.sleepeducation.org/find-a-facility" target="_blank">Locate a sleep facility near you</a>
            </p>
            <p class="my-4 low-risk">
              <div class="flex flex-col w-full md:flex-row">
                <div class="flex-1 bg-base-300 rounded-box justify-center items-center p-2 shadow-xl">
                  <div class="h-full flex flex-col justify-center items-center text-center">
                    Back to the <a href="https://railroadersleep.fra.dot.gov" class="link link-primary">Railroaders' Guide to Healthy Sleep</a>
                  </div>
                </div>
                <div class="divider md:divider-horizontal"></div>
                <div class="flex-1 bg-base-300 rounded-box place-items-center p-2 shadow-xl">
                  <div class="h-full flex flex-col justify-center items-center text-center">
                    More information about sleep disorders can be found at the <a href="https://sleepeducation.org/sleep-disorders/" target="_blank" class="link link-primary">American Academy of Sleep Medicine</a>
                  </div>
                </div>
              </div>
            </p>
          </div>
        </div>
      </div>

      <!-- Save and Print Buttons -->
      <div id="save" class="print:hidden mx-auto high-risk">
        <div class="grid md:grid-cols-2 justify-around">
          <button class="m-2 btn btn-accent flex-0 w-64" id="screenshot">Save Results <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"><path d="M10 21.4v-7.006a.6.6 0 0 1 .6-.6h1.173a.6.6 0 0 0 .504-.275l1.446-2.244a.6.6 0 0 1 .504-.275h3.546a.6.6 0 0 1 .504.275l1.446 2.244a.6.6 0 0 0 .504.275H21.4a.6.6 0 0 1 .6.6V21.4a.6.6 0 0 1-.6.6H10.6a.6.6 0 0 1-.6-.6Z"></path><path d="M16 19a2 2 0 1 0 0-4a2 2 0 0 0 0 4ZM3 18v3h2.5M3 9.5v5M3 6V3h3m3.5 0h5M18 3h3v2.5m0 4.5V8.5"></path></g></svg></button>
          <button class="m-2 btn btn-accent flex-0 w-64" id="print-button">Print <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512"><path fill="currentColor" d="M420 128.1V16H92v112.1A80.1 80.1 0 0 0 16 208v192h68v-32H48V208a48.054 48.054 0 0 1 48-48h320a48.054 48.054 0 0 1 48 48v160h-44v32h76V208a80.1 80.1 0 0 0-76-79.9Zm-32-.1H124V48h264Z"></path><path fill="currentColor" d="M396 200h32v32h-32zm-280 64H76v32h40v200h272V296h40v-32H116Zm240 200H148V296h208Z"></path></svg></button>
        </div>
        <!-- Screenshot Modal -->
        <dialog id="screenshot-modal" class="modal">
          <div class="modal-box w-11/12 max-w-5xl">
            <div class="modal-header">
              <h3 class="text-2xl font-bold">Save Results</h3>
            <div id="screenshot-result">
            </div>
            <div class="modal-action">
              <button class="btn btn-primary" id="download-screenshot">Download</button>
              <form method="dialog">
                <button class="btn">Close</button>
              </form>
            </div>
          </div>
        </dialog>

      </div>
      <Notice />

    </section>
  </main>

  <script>
    // load the sessionStorage data to see if high-risk classes should be hidden
    let screenStoreData = JSON.parse(sessionStorage.getItem("screenStore"))
    let lowrisk = true
    if (screenStoreData) {
      Object.entries(screenStoreData.screenStore).forEach(([key, value]) => {
        if (value.result == "Y") {
          lowrisk = false
          document.querySelectorAll(`.${key}`).forEach((el) => {
            el.classList.remove("hidden")
          })
          document.querySelectorAll(".high-risk").forEach((el) => {
            el.classList.remove("hidden")
          })
          document.querySelectorAll(".low-risk").forEach((el) => {
            el.classList.add("hidden")
          })
        }
      })
    }
    if (lowrisk) {
      document.querySelectorAll(".high-risk").forEach((el) => {
        el.classList.add("hidden")
      })
      document.querySelectorAll(".low-risk").forEach((el) => {
        el.classList.remove("hidden")
      })
    }
    // only show the results once the page is loaded
    document.querySelector("#save-content").classList.remove("hidden")
  </script>
  <script src="../js/screenshot.js"></script>
  <script src="../js/print.js"></script>
</Layout>
